;define(function(){function l(A){var x=new Array();var z=A.length;var B=parseInt(z/4);var C=z%4;var y=0;for(y=0;y<B;y++){x[y]=a(A.substring(y*4+0,y*4+4))}if(C>0){x[y]=a(A.substring(y*4+0,z))}return x}function a(F){var x=F.length;var G=new Array(64);if(x<4){var D=0,C=0,z=0,y=0;for(D=0;D<x;D++){var B=F.charCodeAt(D);for(C=0;C<16;C++){var E=1,A=0;for(A=15;A>C;A--){E*=2}G[16*D+C]=parseInt(B/E)%2}}for(z=x;z<4;z++){var B=0;for(y=0;y<16;y++){var E=1,A=0;for(A=15;A>y;A--){E*=2}G[16*z+y]=parseInt(B/E)%2}}}else{for(D=0;D<4;D++){var B=F.charCodeAt(D);for(C=0;C<16;C++){var E=1;for(A=15;A>C;A--){E*=2}G[16*D+C]=parseInt(B/E)%2}}}return G}function b(y){var x;switch(y){case"0000":x="0";break;case"0001":x="1";break;case"0010":x="2";break;case"0011":x="3";break;case"0100":x="4";break;case"0101":x="5";break;case"0110":x="6";break;case"0111":x="7";break;case"1000":x="8";break;case"1001":x="9";break;case"1010":x="A";break;case"1011":x="B";break;case"1100":x="C";break;case"1101":x="D";break;case"1110":x="E";break;case"1111":x="F";break}return x}function g(x){var y;switch(x){case"0":y="0000";break;case"1":y="0001";break;case"2":y="0010";break;case"3":y="0011";break;case"4":y="0100";break;case"5":y="0101";break;case"6":y="0110";break;case"7":y="0111";break;case"8":y="1000";break;case"9":y="1001";break;case"A":y="1010";break;case"B":y="1011";break;case"C":y="1100";break;case"D":y="1101";break;case"E":y="1110";break;case"F":y="1111";break}return y}function r(A){var z="";for(i=0;i<4;i++){var y=0;for(j=0;j<16;j++){var x=1;for(m=15;m>j;m--){x*=2}y+=A[16*i+j]*x}if(y!=0){z+=String.fromCharCode(y)}}return z}function f(z){var y="";for(i=0;i<16;i++){var x="";for(j=0;j<4;j++){x+=z[i*4+j]}y+=b(x)}return y}function c(x){var y="";for(i=0;i<16;i++){y+=g(x.substring(i,i+1))}return y}function e(y,I){var L=s(I);var H=v(y);var z=new Array(32);var K=new Array(32);var D=new Array(32);var G=0,F=0,E=0,C=0,B=0;for(E=0;E<32;E++){z[E]=H[E];K[E]=H[32+E]}for(G=0;G<16;G++){for(F=0;F<32;F++){D[F]=z[F];z[F]=K[F]}var J=new Array(48);for(C=0;C<48;C++){J[C]=L[G][C]}var x=q(p(o(q(t(K),J))),D);for(B=0;B<32;B++){K[B]=x[B]}}var A=new Array(64);for(G=0;G<32;G++){A[G]=K[G];A[32+G]=z[G]}return u(A)}function h(y,I){var L=s(I);var H=v(y);var z=new Array(32);var K=new Array(32);var D=new Array(32);var G=0,F=0,E=0,C=0,B=0;for(E=0;E<32;E++){z[E]=H[E];K[E]=H[32+E]}for(G=15;G>=0;G--){for(F=0;F<32;F++){D[F]=z[F];z[F]=K[F]}var J=new Array(48);for(C=0;C<48;C++){J[C]=L[G][C]}var x=q(p(o(q(t(K),J))),D);for(B=0;B<32;B++){K[B]=x[B]}}var A=new Array(64);for(G=0;G<32;G++){A[G]=K[G];A[32+G]=z[G]}return u(A)}function v(y){var x=new Array(64);for(i=0,m=1,n=0;i<4;i++,m+=2,n+=2){for(j=7,k=0;j>=0;j--,k++){x[i*8+k]=y[j*8+m];x[i*8+k+32]=y[j*8+n]}}return x}function t(x){var y=new Array(48);for(i=0;i<8;i++){if(i==0){y[i*6+0]=x[31]}else{y[i*6+0]=x[i*4-1]}y[i*6+1]=x[i*4+0];y[i*6+2]=x[i*4+1];y[i*6+3]=x[i*4+2];y[i*6+4]=x[i*4+3];if(i==7){y[i*6+5]=x[0]}else{y[i*6+5]=x[i*4+4]}}return y}function q(z,y){var x=new Array(z.length);for(i=0;i<z.length;i++){x[i]=z[i]^y[i]}return x}function o(z){var x=new Array(32);var B="";var J=[[14,4,13,1,2,15,11,8,3,10,6,12,5,9,0,7],[0,15,7,4,14,2,13,1,10,6,12,11,9,5,3,8],[4,1,14,8,13,6,2,11,15,12,9,7,3,10,5,0],[15,12,8,2,4,9,1,7,5,11,3,14,10,0,6,13]];var I=[[15,1,8,14,6,11,3,4,9,7,2,13,12,0,5,10],[3,13,4,7,15,2,8,14,12,0,1,10,6,9,11,5],[0,14,7,11,10,4,13,1,5,8,12,6,9,3,2,15],[13,8,10,1,3,15,4,2,11,6,7,12,0,5,14,9]];var H=[[10,0,9,14,6,3,15,5,1,13,12,7,11,4,2,8],[13,7,0,9,3,4,6,10,2,8,5,14,12,11,15,1],[13,6,4,9,8,15,3,0,11,1,2,12,5,10,14,7],[1,10,13,0,6,9,8,7,4,15,14,3,11,5,2,12]];var G=[[7,13,14,3,0,6,9,10,1,2,8,5,11,12,4,15],[13,8,11,5,6,15,0,3,4,7,2,12,1,10,14,9],[10,6,9,0,12,11,7,13,15,1,3,14,5,2,8,4],[3,15,0,6,10,1,13,8,9,4,5,11,12,7,2,14]];var F=[[2,12,4,1,7,10,11,6,8,5,3,15,13,0,14,9],[14,11,2,12,4,7,13,1,5,0,15,10,3,9,8,6],[4,2,1,11,10,13,7,8,15,9,12,5,6,3,0,14],[11,8,12,7,1,14,2,13,6,15,0,9,10,4,5,3]];var E=[[12,1,10,15,9,2,6,8,0,13,3,4,14,7,5,11],[10,15,4,2,7,12,9,5,6,1,13,14,0,11,3,8],[9,14,15,5,2,8,12,3,7,0,4,10,1,13,11,6],[4,3,2,12,9,5,15,10,11,14,1,7,6,0,8,13]];var D=[[4,11,2,14,15,0,8,13,3,12,9,7,5,10,6,1],[13,0,11,7,4,9,1,10,14,3,5,12,2,15,8,6],[1,4,11,13,12,3,7,14,10,15,6,8,0,5,9,2],[6,11,13,8,1,4,10,7,9,5,0,15,14,2,3,12]];var C=[[13,2,8,4,6,15,11,1,10,9,3,14,5,0,12,7],[1,15,13,8,10,3,7,4,12,5,6,11,0,14,9,2],[7,11,4,1,9,12,14,2,0,6,10,13,15,3,5,8],[2,1,14,7,4,10,8,13,15,12,9,0,3,5,6,11]];for(m=0;m<8;m++){var A=0,y=0;A=z[m*6+0]*2+z[m*6+5];y=z[m*6+1]*2*2*2+z[m*6+2]*2*2+z[m*6+3]*2+z[m*6+4];switch(m){case 0:B=w(J[A][y]);break;case 1:B=w(I[A][y]);break;case 2:B=w(H[A][y]);break;case 3:B=w(G[A][y]);break;case 4:B=w(F[A][y]);break;case 5:B=w(E[A][y]);break;case 6:B=w(D[A][y]);break;case 7:B=w(C[A][y]);break}x[m*4+0]=parseInt(B.substring(0,1));x[m*4+1]=parseInt(B.substring(1,2));x[m*4+2]=parseInt(B.substring(2,3));x[m*4+3]=parseInt(B.substring(3,4))}return x}function p(y){var x=new Array(32);x[0]=y[15];x[1]=y[6];x[2]=y[19];x[3]=y[20];x[4]=y[28];x[5]=y[11];x[6]=y[27];x[7]=y[16];x[8]=y[0];x[9]=y[14];x[10]=y[22];x[11]=y[25];x[12]=y[4];x[13]=y[17];x[14]=y[30];x[15]=y[9];x[16]=y[1];x[17]=y[7];x[18]=y[23];x[19]=y[13];x[20]=y[31];x[21]=y[26];x[22]=y[2];x[23]=y[8];x[24]=y[18];x[25]=y[12];x[26]=y[29];x[27]=y[5];x[28]=y[21];x[29]=y[10];x[30]=y[3];x[31]=y[24];return x}function u(x){var y=new Array(64);y[0]=x[39];y[1]=x[7];y[2]=x[47];y[3]=x[15];y[4]=x[55];y[5]=x[23];y[6]=x[63];y[7]=x[31];y[8]=x[38];y[9]=x[6];y[10]=x[46];y[11]=x[14];y[12]=x[54];y[13]=x[22];y[14]=x[62];y[15]=x[30];y[16]=x[37];y[17]=x[5];y[18]=x[45];y[19]=x[13];y[20]=x[53];y[21]=x[21];y[22]=x[61];y[23]=x[29];y[24]=x[36];y[25]=x[4];y[26]=x[44];y[27]=x[12];y[28]=x[52];y[29]=x[20];y[30]=x[60];y[31]=x[28];y[32]=x[35];y[33]=x[3];y[34]=x[43];y[35]=x[11];y[36]=x[51];y[37]=x[19];y[38]=x[59];y[39]=x[27];y[40]=x[34];y[41]=x[2];y[42]=x[42];y[43]=x[10];y[44]=x[50];y[45]=x[18];y[46]=x[58];y[47]=x[26];y[48]=x[33];y[49]=x[1];y[50]=x[41];y[51]=x[9];y[52]=x[49];y[53]=x[17];y[54]=x[57];y[55]=x[25];y[56]=x[32];y[57]=x[0];y[58]=x[40];y[59]=x[8];y[60]=x[48];y[61]=x[16];y[62]=x[56];y[63]=x[24];return y}function w(x){var y="";switch(x){case 0:y="0000";break;case 1:y="0001";break;case 2:y="0010";break;case 3:y="0011";break;case 4:y="0100";break;case 5:y="0101";break;case 6:y="0110";break;case 7:y="0111";break;case 8:y="1000";break;case 9:y="1001";break;case 10:y="1010";break;case 11:y="1011";break;case 12:y="1100";break;case 13:y="1101";break;case 14:y="1110";break;case 15:y="1111";break}return y}function s(z){var B=new Array(56);var C=new Array();C[0]=new Array();C[1]=new Array();C[2]=new Array();C[3]=new Array();C[4]=new Array();C[5]=new Array();C[6]=new Array();C[7]=new Array();C[8]=new Array();C[9]=new Array();C[10]=new Array();C[11]=new Array();C[12]=new Array();C[13]=new Array();C[14]=new Array();C[15]=new Array();var x=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];for(A=0;A<7;A++){for(j=0,k=7;j<8;j++,k--){B[A*8+j]=z[8*k+A]}}var A=0;for(A=0;A<16;A++){var E=0;var y=0;for(j=0;j<x[A];j++){E=B[0];y=B[28];for(k=0;k<27;k++){B[k]=B[k+1];B[28+k]=B[29+k]}B[27]=E;B[55]=y}var D=new Array(48);D[0]=B[13];D[1]=B[16];D[2]=B[10];D[3]=B[23];D[4]=B[0];D[5]=B[4];D[6]=B[2];D[7]=B[27];D[8]=B[14];D[9]=B[5];D[10]=B[20];D[11]=B[9];D[12]=B[22];D[13]=B[18];D[14]=B[11];D[15]=B[3];D[16]=B[25];D[17]=B[7];D[18]=B[15];D[19]=B[6];D[20]=B[26];D[21]=B[19];D[22]=B[12];D[23]=B[1];D[24]=B[40];D[25]=B[51];D[26]=B[30];D[27]=B[36];D[28]=B[46];D[29]=B[54];D[30]=B[29];D[31]=B[39];D[32]=B[50];D[33]=B[44];D[34]=B[32];D[35]=B[47];D[36]=B[43];D[37]=B[48];D[38]=B[38];D[39]=B[55];D[40]=B[33];D[41]=B[52];D[42]=B[45];D[43]=B[41];D[44]=B[49];D[45]=B[35];D[46]=B[28];D[47]=B[31];switch(A){case 0:for(m=0;m<48;m++){C[0][m]=D[m]}break;case 1:for(m=0;m<48;m++){C[1][m]=D[m]}break;case 2:for(m=0;m<48;m++){C[2][m]=D[m]}break;case 3:for(m=0;m<48;m++){C[3][m]=D[m]}break;case 4:for(m=0;m<48;m++){C[4][m]=D[m]}break;case 5:for(m=0;m<48;m++){C[5][m]=D[m]}break;case 6:for(m=0;m<48;m++){C[6][m]=D[m]}break;case 7:for(m=0;m<48;m++){C[7][m]=D[m]}break;case 8:for(m=0;m<48;m++){C[8][m]=D[m]}break;case 9:for(m=0;m<48;m++){C[9][m]=D[m]}break;case 10:for(m=0;m<48;m++){C[10][m]=D[m]}break;case 11:for(m=0;m<48;m++){C[11][m]=D[m]}break;case 12:for(m=0;m<48;m++){C[12][m]=D[m]}break;case 13:for(m=0;m<48;m++){C[13][m]=D[m]}break;case 14:for(m=0;m<48;m++){C[14][m]=D[m]}break;case 15:for(m=0;m<48;m++){C[15][m]=D[m]}break}}return C}return function d(W,P,A,D){var G=W.length;var H="";var T,Q,N,X,F,I;if(P!=null&&P!=""){T=l(P);X=T.length}if(A!=null&&A!=""){Q=l(A);F=Q.length}if(D!=null&&D!=""){N=l(D);I=N.length}if(G>0){if(G<4){var U=a(W);var E;if(P!=null&&P!=""&&A!=null&&A!=""&&D!=null&&D!=""){var S;var L,K,J;S=U;for(L=0;L<X;L++){S=e(S,T[L])}for(K=0;K<F;K++){S=e(S,Q[K])}for(J=0;J<I;J++){S=e(S,N[J])}E=S}else{if(P!=null&&P!=""&&A!=null&&A!=""){var S;var L,K;S=U;for(L=0;L<X;L++){S=e(S,T[L])}for(K=0;K<F;K++){S=e(S,Q[K])}E=S}else{if(P!=null&&P!=""){var S;var L=0;S=U;for(L=0;L<X;L++){S=e(S,T[L])}E=S}}}H=f(E)}else{var O=parseInt(G/4);var M=G%4;var R=0;for(R=0;R<O;R++){var C=W.substring(R*4+0,R*4+4);var V=a(C);var E;if(P!=null&&P!=""&&A!=null&&A!=""&&D!=null&&D!=""){var S;var L,K,J;S=V;for(L=0;L<X;L++){S=e(S,T[L])}for(K=0;K<F;K++){S=e(S,Q[K])}for(J=0;J<I;J++){S=e(S,N[J])}E=S}else{if(P!=null&&P!=""&&A!=null&&A!=""){var S;var L,K;S=V;for(L=0;L<X;L++){S=e(S,T[L])}for(K=0;K<F;K++){S=e(S,Q[K])}E=S}else{if(P!=null&&P!=""){var S;var L;S=V;for(L=0;L<X;L++){S=e(S,T[L])}E=S}}}H+=f(E)}if(M>0){var B=W.substring(O*4+0,G);var V=a(B);var E;if(P!=null&&P!=""&&A!=null&&A!=""&&D!=null&&D!=""){var S;var L,K,J;S=V;for(L=0;L<X;L++){S=e(S,T[L])}for(K=0;K<F;K++){S=e(S,Q[K])}for(J=0;J<I;J++){S=e(S,N[J])}E=S}else{if(P!=null&&P!=""&&A!=null&&A!=""){var S;var L,K;S=V;for(L=0;L<X;L++){S=e(S,T[L])}for(K=0;K<F;K++){S=e(S,Q[K])}E=S}else{if(P!=null&&P!=""){var S;var L;S=V;for(L=0;L<X;L++){S=e(S,T[L])}E=S}}}H+=f(E)}}}return H}});